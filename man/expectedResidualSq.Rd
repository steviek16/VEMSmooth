% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/helpers - beta.R
\name{expectedResidualSq}
\alias{expectedResidualSq}
\title{helpers - beta: beta-related expectation helpers}
\usage{
expectedResidualSq(B, i, y, mu, Sigma, prob, iter, psi)
}
\arguments{
\item{B}{List of basis matrices (B[\link{i}] is n_i x K).}

\item{i}{Curve index.}

\item{y}{List of observations (y[\link{i}] is length n_i vector).}

\item{mu}{Matrix of posterior beta means (rows = iterations, cols = beta_k_i).}

\item{Sigma}{Array of posterior beta covariance matrices (K x K x m).}

\item{prob}{Matrix of inclusion probabilities (rows = iterations, cols = beta_k_i).}

\item{iter}{Current iteration index.}

\item{psi}{Correlation matrix for the errors.}
}
\value{
Numeric expected squared (or summed squared) values.
}
\description{
Expected squared residuals and beta^2 moments under the variational posterior.
These are used in the updates of q(sigma^2), q(tau^2), and q(Z_ki).
}
\keyword{internal}
